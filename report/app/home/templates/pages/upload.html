{% extends "pages/main.html" %}

{% block title %}Search{% endblock %}
{% block style %}
{% load static %}
<link href="{% static 'css/upload-image.css' %}" rel="stylesheet" type="text/css" />
{% endblock %}
{% block content %}
<div class="banner">
   <div class="container">
      <div class="row">
         <div class="col-md-6 offset-md-3 ">
            <div class="header-text caption">
               <h2>Search your face</h2>
               <span class="mb-5" style="color: white;">Choose the image and wait for the magic :v</span>
            </div>
            <div id="search-section">

               <form method="post" enctype="multipart/form-data">
                  {% csrf_token %}
                  <input id="file" class="inputfile" type="file" name="document" accept="image/png, image/jpeg" />
                  <label for="file">Choose a file...<i class="fas fa-cloud-upload-alt ml-3"
                        aria-hidden="true"></i></label>
                  <select class="featureselect btn btn-outline-light" name="choose_method">
                     <option value="1" selected>Hog</option>
                     <option value="2" >Sift Feature</option>
                     <option value="3" >Mix Sift_n_Hog</option>
                     <option value="4">VGG16</option>
                  </select>
                  <input placeholder="Enter k..." type="text" class="knumber btn btn-outline-light" name="knumber" />
                  <button class="btn btn-outline-light" type="submit"> Search</button>
               </form>

            </div>
         </div>
      </div>
   </div>
</div>

<div class="row">
   <div class="col-sm-3">
         <div class="row">
               <div class="col-md-12">
                     <div class="section-heading">
                        <h2>Image you chose</h2>
                        <p>Chỗ này nữa <br>
                           Chỗ này nữa</p>
                     </div>
                  </div>
      <img class="uploadimg mt-4" width=100% src="../upload_img/{{origin}}" id="preview" class="img-thumbnail">
   </div>
   </div>
   <div class="col-sm-9">
      <div class="center">
         <div class="row">
            <div class="col-md-8 offset-md-2">
               <div class="section-heading">
                  <h2>The similarity faces</h2>
                  <p>Chắc phải ghi cái gì vào chỗ này cho đỡ trống <br>
                     Chắc phải ghi cái gì vào chỗ này cho đỡ trống</p>
               </div>
            </div>
            {% for infor in information %}
            <div class="col-3 mb-4">
               <img style="display:block;" width="100%" src="{{infor.img}}">
               <div class="down-content">
                  <center>
                     {{infor.name}} : {{infor.description}}
                     {% comment %} this is img's name {% endcomment %}
                  </center>
               </div>

            </div>
            {% endfor %}
         </div>
      </div>
   </div>
</div>
</div>
<script>
   var inputs = document.querySelectorAll('.inputfile');
   Array.prototype.forEach.call(inputs, function (input) {
      var label = input.nextElementSibling;
      input.addEventListener('change', function (e) {
         var fileName = e.target.value.split('\\').pop();
         label.innerHTML = fileName;
         var reader = new FileReader();
         reader.onload = function (e) {
            // get loaded data and render thumbnail.
            document.getElementById("preview").src = e.target.result;
         };
         // read the image file as a data URL.
         reader.readAsDataURL(this.files[0]);
      });
   });
</script>
{% endblock %}